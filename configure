#!/bin/sh


for arg in "$@"; do
    case "$arg" in
        --prefix=*)
            PREFIX=`echo $arg | sed 's/--prefix=//'`
            echo "PREFIX = $PREFIX" > Makefile
            printf "#!/usr/bin/env python\nPREFIX=\"$PREFIX\"\n\n" > src/mousetrap.py
            cat "mousetrap.in" >> src/mousetrap.py
            chmod a+x src/mousetrap.py
        ;;

    esac
done

if [ -z "$PREFIX" ]; then
    echo "PREFIX = /usr/local" > Makefile
    printf "#!/usr/bin/env python\nPREFIX=\"/usr/local\"\n\n" > src/mousetrap.py
    cat "mousetrap.in" >> src/mousetrap.py
    chmod a+x src/mousetrap.py
fi

cat Makefile.in >> Makefile

echo "Configuration complete. Type 'make' to build."
